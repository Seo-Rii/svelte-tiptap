import{_ as l,$ as h,a0 as u,S as m,i as p,s as f,e as E,c as y,a as D,d as c,g as M,K as a,v as b,a1 as O,a2 as v,E as w,O as g}from"./vendor-eb0bebae.js";class N extends l{constructor(){super(...arguments);this.contentElement=null}}const V=o=>{const e=new N(o),{subscribe:t}=h(e,s=>(e.on("transaction",()=>{s(e)}),()=>{e.destroy()}));return{subscribe:t}};class S{constructor(e,{element:t}){this.component=e,this.dom=t,this.dom.classList.add("svelte-renderer")}updateProps(e){this.component.$set(e)}destroy(){this.component.$destroy()}}const _="TitTapNodeView";class C extends u{mount(){const e=this.component,t={editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(d={})=>this.updateAttributes(d),deleteNode:()=>this.deleteNode()};this.contentDOMElement=this.node.isLeaf?null:document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.style.whiteSpace="inherit");const s=new Map;s.set(_,{isInline:this.node.isInline,onDragStart:this.onDragStart.bind(this)});const n=document.createElement("div"),r=new e({target:n,props:t,context:s});this.renderer=new S(r,{element:n})}get dom(){return this.renderer.dom}get contentDOM(){return this.node.isLeaf?null:(this.maybeMoveContentDOM(),this.contentDOMElement)}maybeMoveContentDOM(){const e=this.dom.querySelector("[data-node-view-content]");this.contentDOMElement&&e&&!e.contains(this.contentDOMElement)&&e.appendChild(this.contentDOMElement)}update(e,t){return typeof this.options.update=="function"?this.options.update(e,t):e.type!==this.node.type?!1:(e===this.node&&this.decorations===t||(this.node=e,this.decorations=t,this.renderer.updateProps({node:e,decorations:t}),this.maybeMoveContentDOM()),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}destroy(){this.renderer.destroy(),this.contentDOMElement=null}}const A=(o,e)=>t=>new C(o,t,e);function P(o){let e;return{c(){e=E("div")},l(t){e=y(t,"DIV",{}),D(e).forEach(c)},m(t,s){M(t,e,s),o[2](e)},p:a,i:a,o:a,d(t){t&&c(e),o[2](null)}}}function x(o,e,t){let s,{editor:n}=e;const r=async()=>{await w(),!(!n||!n.options.element)&&(n.contentElement||(s.append(...Array.from(n.options.element.childNodes)),n.setOptions({element:s}),t(1,n.contentElement=s,n)))};b(r),O(r),v(()=>{if(!n||(t(1,n.contentElement=null,n),!n.options.element.firstChild))return;const i=document.createElement("div");i.append(...Array.from(n.options.element.childNodes)),n.setOptions({element:i})});function d(i){g[i?"unshift":"push"](()=>{s=i,t(0,s)})}return o.$$set=i=>{"editor"in i&&t(1,n=i.editor)},[s,n,d]}class T extends m{constructor(e){super();p(this,e,x,P,f,{editor:1})}}export{T as E,A as S,_ as T,V as c};
